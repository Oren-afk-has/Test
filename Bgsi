local TweenService = game:GetService("TweenService")
local player = game.Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local hrp = char:WaitForChild("HumanoidRootPart")

local function isBagFull()
	local gui = player:WaitForChild("PlayerGui"):WaitForChild("MainGUI").Game.CoinBags.Container
	local egg = gui:FindFirstChild("Egg")
	local coin = gui:FindFirstChild("Coin")
	return egg and egg:FindFirstChild("Full") and egg.Full.Visible and coin and coin:FindFirstChild("Full") and coin.Full.Visible
end

local function getClosestCoin(coins)
	local closest, minDist = nil, math.huge
	for _, coin in ipairs(coins) do
		local part = coin:IsA("BasePart") and coin or coin:FindFirstChildWhichIsA("BasePart")
		if part then
			local dist = (hrp.Position - part.Position).Magnitude
			if dist < minDist then
				closest, minDist = part, dist
			end
		end
	end
	return closest
end

local map = workspace:FindFirstChildWhichIsA("Model", true)
local coins = map and map:FindFirstChild("CoinContainer")
if not coins then return end

while true do
	if isBagFull() then
		char:BreakJoints()
		return
	end

	local closest = getClosestCoin(coins:GetChildren())
	if closest then
		local dist = (hrp.Position - closest.Position).Magnitude
		TweenService:Create(hrp, TweenInfo.new(dist * 0.07, Enum.EasingStyle.Sine), {CFrame = CFrame.new(closest.Position + Vector3.new(0, 5, 0))}):Play()
		wait(dist * 0.07)
	end
	wait()
end
